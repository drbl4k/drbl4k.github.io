<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on drbl4k blogs</title>
    <link>https://drbl4k.github.io/posts/</link>
    <description>Recent content in Posts on drbl4k blogs</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Fri, 01 Aug 2025 00:10:21 +0530</lastBuildDate><atom:link href="https://drbl4k.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Unusual Authentication and 2FA Bypasses (A Grey-Box Approach)</title>
      <link>https://drbl4k.github.io/posts/unusual-authentication-and-2fa-bypasses-a-grey-box-approach/</link>
      <pubDate>Fri, 01 Aug 2025 00:10:21 +0530</pubDate>
      
      <guid>https://drbl4k.github.io/posts/unusual-authentication-and-2fa-bypasses-a-grey-box-approach/</guid>
      <description>Authentication and 2FA bypasses have some “usual” methodologies, and I would like to keep them under honorable mentions as we are not covering them today. Also when we talk about authentication &amp;amp; 2FA bypasses specifically, we often think about a scenario where we manage to log into an application/asset without valid verifier/password. That is what I have covered today.
Today’s blog is all about my experience with weird bypasses that I encountered during various pentest activities.</description>
      <content>&lt;p&gt;Authentication and 2FA bypasses have some “usual” methodologies, and I would like to keep them under honorable mentions as we are not covering them today. Also when we talk about authentication &amp;amp; 2FA bypasses specifically, we often think about a scenario where we manage to log into an application/asset without valid verifier/password. That is what I have covered today.&lt;/p&gt;
&lt;p&gt;Today’s blog is all about my experience with weird bypasses that I encountered during various pentest activities. Yes the techniques are covered as well. &lt;em&gt;(#igotchu)&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;honorable-mentions&#34;&gt;Honorable Mentions&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Auth/2FA bypass via &lt;strong&gt;typical&lt;/strong&gt; response manipulation (“200 OK” scenario)&lt;/li&gt;
&lt;li&gt;SQL injection for login bypasses. (OR 1=1 — or something better)&lt;/li&gt;
&lt;li&gt;JWT with none algorithm set in the request. (Mostly outdated)&lt;/li&gt;
&lt;li&gt;OTP brute-force without rate limiting. (Typical test case)&lt;/li&gt;
&lt;li&gt;OTP reuse (extremely rare and a usual test case)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now keeping the above out of the way, let’s begin with the unusual stuff.&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer&lt;/strong&gt;: the below shown POCs are not from a real world application. Keeping confidentiality in mind I tried to &lt;strong&gt;simulate&lt;/strong&gt; the same attacks over a &lt;strong&gt;secure environment&lt;/strong&gt;. However, the below discussed techniques were used in a real web application assessment.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h3 id=&#34;authentication-bypass&#34;&gt;Authentication Bypass&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;An IDOR based authentication bypass (response manipulation):&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;You can test this out in applications with multiple user roles/accounts where, the email and the role ID are returned in the response.&lt;/p&gt;
&lt;p&gt;Original Request:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;Username&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pt-readonly&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Password&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SuperSecurePassword&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Original Response:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;status&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pt-readonly&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;roleID&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Simply try logging in with a set of credentials and intercept the response. Once the response is received, change the email and role ID to a different user &lt;em&gt;&lt;strong&gt;(this may vary as some apps might return only email and some generic parameters like date name etc.)&lt;/strong&gt;&lt;/em&gt; and forward the response. Now check weather the you logged in as a different user.&lt;/p&gt;
&lt;p&gt;Original Response:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;status&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pt-readonly&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;roleID&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Tampered Response:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;status&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;pt-admin&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;roleID&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;sometimes just tampering the “roleID” might lead to privilege escalation, but that depends on various other factors.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;JWT None algorithm tampered in response (response manipulation):&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Lets say, you have done basic response manipulation, but you noticed that the server returns a token on a successful login. In this case, log into the application once and copy the token. Set the algorithm type to “None” and remove the signature. Now try intercepting the response again with a wrong password, and paste the token parameter with the crafted token in the response and forward it. This may vary on the basis of signature. You may require a dummy one to be part of the crafted token in some apps.&lt;/p&gt;
&lt;p&gt;Original JWT:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAZXhhbXBsZS5jb20iLCJyb2xlIjoidXNlciIsInJvbGVfaWQiOiIxMDAyIiwiZXhwIjoxNzIyNDI1Mjc3fQ._Ml1VzOvHcmKHY2ElPBWjHbNdG56pYBvAhyHZdcSIAI
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
{&amp;#34;alg&amp;#34;: &amp;#34;HS256&amp;#34;,&amp;#34;typ&amp;#34;: &amp;#34;JWT&amp;#34;}.{&amp;#34;email&amp;#34;: &amp;#34;user@example.com&amp;#34;,&amp;#34;role&amp;#34;: &amp;#34;user&amp;#34;,&amp;#34;role_id&amp;#34;: &amp;#34;1002&amp;#34;,&amp;#34;exp&amp;#34;: 1722425277}._Ml1VzOvHcmKHY2ElPBWjHbNdG56pYBvAhyHZdcSIAI
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;None Alg JWT:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6ImFkbWluQGV4YW1wbGUuY29tIiwicm9sZSI6ImFkbWluIiwicm9sZV9pZCI6IjEwMDEiLCJleHAiOjE3MjI0MjUyNzd9.
---------------------------------------------------------------------------------------------------------------------------------------------
{&amp;#34;alg&amp;#34;: &amp;#34;none&amp;#34;,&amp;#34;typ&amp;#34;: &amp;#34;JWT&amp;#34;}.{&amp;#34;email&amp;#34;: &amp;#34;user@example.com&amp;#34;,&amp;#34;role&amp;#34;: &amp;#34;user&amp;#34;,&amp;#34;role_id&amp;#34;: &amp;#34;1002&amp;#34;,&amp;#34;exp&amp;#34;: 1722425277}.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Original Response:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;status&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;token&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAZXhhbXBsZS5jb20iLCJyb2xlIjoidXNlciIsInJvbGVfaWQiOiIxMDAyIiwiZXhwIjoxNzIyNDI1Mjc3fQ.._Ml1VzOvHcmKHY2ElPBWjHbNdG56pYBvAhyHZdcSIAI&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;roleID&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Bypass response:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;#34;status&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;success&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;token&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6ImFkbWluQGV4YW1wbGUuY29tIiwicm9sZSI6ImFkbWluIiwicm9sZV9pZCI6IjEwMDEiLCJleHAiOjE3MjI0MjUyNzd9.&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;	&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;roleID&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;4&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;Hardcoded token/credentials (JavaScript analysis):&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This one is pretty hard as most apps are secure enough not to include such blunders in code. But who knows? this was encountered personally by myself during a pentest 😎. Go to the Burp’s HTTP History and filter all the .js (JavaScript) &amp;amp; .json files. select a request and paste the username format/email/JWT regex. and move through the requests. there is 1 in a million chance for that.&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;/image.png&#34; src=&#34;https://drbl4k.github.io/images/Unusual-Authentication-and-2FA-Bypases/image.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;here is a list of regex that could help you out while searching for some hardcoded stuff,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;“^[a-zA-Z0-9]+([._-][a-zA-Z0-9]+)*@[a-zA-Z0-9-]+.[a-zA-Z]{2,}$”   — &lt;strong&gt;Covers emails&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;“eyJ[A-Za-z0-9_-]+?.[A-Za-z0-9_-]+?.[A-Za-z0-9_-]+”   — &lt;strong&gt;Covers JWT tokens&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;“\b(?:(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2}).){3}(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2})\b”   — &lt;strong&gt;IPv4 address&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;“\b(?:[A-Fa-f0-9]{1,4}:){7}[A-Fa-f0-9]{1,4}\b”  — &lt;strong&gt;IPv6 address&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;two-factor-authentication-bypass&#34;&gt;Two Factor Authentication Bypass&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;(For this part I’m not covering usual things like brute force and response copy pate, identifying static OTPs as they those will be identified by Burp’s active scan.&lt;/em&gt;)&lt;/p&gt;
&lt;p&gt;This is interesting because, the third one really was a new approach to OTP bypass which doesn’t involve touching the OTP at all (#tempting) 🤓.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;em&gt;&lt;strong&gt;Downgrade APIs to lower version:&lt;/strong&gt;&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This one is pretty close to my heart, I found this downgrade issue across multiple apps where upon downgrading the API version say from v2 to v1, I managed to revel some sensitive (unintended) information about the flow and this in most cases allow OTP brute forcing, response manipulation. Maybe in some cases a default OTP would be present for that particular version (Haven’t got but heard).&lt;/p&gt;
&lt;p&gt;Version 2 Request (Original):&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;POST /api**/v2/**verify-otp HTTP/1.1
Host: example.com
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  &amp;#34;email&amp;#34;: &amp;#34;user@example.com&amp;#34;,
  &amp;#34;otp&amp;#34;: &amp;#34;927314&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Version 1 Request (Tampered):&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;POST /api**/v1/**verify-otp HTTP/1.1
Host: example.com
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  &amp;#34;email&amp;#34;: &amp;#34;user@example.com&amp;#34;,
  &amp;#34;otp&amp;#34;: &amp;#34;927314&amp;#34;
}
&lt;/code&gt;&lt;/pre&gt;&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Force Browsing Authenticated Page:&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This is a rare thing to find but still out there in the wild. &lt;strong&gt;A race condition&lt;/strong&gt; which allows to force browse the home page directly after the first level of Authentication &lt;em&gt;(password entry)&lt;/em&gt;. Let’s break this down.&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms&#34; src=&#34;https://drbl4k.github.io/images/Unusual-Authentication-and-2FA-Bypases/image2.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Source: &lt;a href=&#34;https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms&#34;&gt;https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;This happens because a multi step sequence takes place within the span of a single request. This means that the user temporarily has a valid session, but MFA isn&amp;rsquo;t yet being enforce. This allows an attacker to force browse the home page before entering the OTP.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Chaining Host Header Injection with OTP emails &lt;em&gt;(#Research):&lt;/em&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We all know that if an application is vulnerable to host header injection, we go straight to password reset functionalities to the same for link poisoning and stuff. What if, an application takes an Email to authenticate with an OTP later has this issue?. Imagine this in a black box application where you have a valid username and password, but 2FA ends up like this. &lt;em&gt;(Actively researching).&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;key-takeaways&#34;&gt;Key Takeaways&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Always tamper the response if emails/roles are returned for horizontal account bypasses&lt;/li&gt;
&lt;li&gt;Try setting a none algorithm token via response manipulation (if returned in response)&lt;/li&gt;
&lt;li&gt;Always look into the JavaScript files for exposures (Check files like main.js, index.js etc.)&lt;/li&gt;
&lt;li&gt;Always make sure to downgrade the APIs if higher numbers are present as current version.&lt;/li&gt;
&lt;li&gt;Make sure to force browse the authenticated page before entering the OTP/Passcode.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;references&#34;&gt;References&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms&#34;&gt;https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://hackerone.com/reports/2463279&#34;&gt;https://hackerone.com/reports/2463279&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://hackerone.com/reports/1490470&#34;&gt;https://hackerone.com/reports/1490470&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.hackerone.com/blog/penetration-testing-api&#34;&gt;https://www.hackerone.com/blog/penetration-testing-api&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Happy Hunting Fellas.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Yours Truly: DRBL4K&lt;/em&gt;&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>In The Plain Sight - A Classic Filter Mistake</title>
      <link>https://drbl4k.github.io/posts/in-the-plain-sight/</link>
      <pubDate>Mon, 28 Jul 2025 21:10:21 +0530</pubDate>
      
      <guid>https://drbl4k.github.io/posts/in-the-plain-sight/</guid>
      <description>Prologue: Being in application security, I usually see mates making this one tiny mistake with their Burpsuite configuration. Lot of testers usually go with the default “HTTP History Filters”. In this blog I will cover the importance of the unchecked filters and how it helped me as well as fellow hackers out in the wild to attain “Path Traversal” and “Server-Side Request Forgery” in a real engagement.
Most of public reports (around 55%) in Hackerone indicate that, the components that are vulnerable to local file inclusions and SSRFs are identified to be either a functionality of an image/other files (ie: PDF, CSV, ZIP etc.</description>
      <content>&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Prologue&lt;/strong&gt;&lt;/em&gt;: Being in application security, I usually see mates making this one tiny mistake with their Burpsuite configuration. Lot of testers usually go with the default  “HTTP History Filters”. In this blog I will cover the importance of the unchecked filters and how it helped me as well as fellow hackers out in the wild to attain &lt;strong&gt;“Path Traversal”&lt;/strong&gt; and &lt;strong&gt;“Server-Side Request Forgery”&lt;/strong&gt; in a real engagement.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;Most of public reports (&lt;em&gt;around 55%&lt;/em&gt;) in &lt;strong&gt;Hackerone&lt;/strong&gt; indicate that, the components that are vulnerable to local file inclusions and SSRFs are identified to be either a functionality of an image/other files &lt;code&gt;(ie: PDF, CSV, ZIP etc.)&lt;/code&gt; being loaded into the application through an external interaction &lt;code&gt;(ie: ?image=https://test.com/a.pdf)&lt;/code&gt; or fetched locally within the file system of the hosted application &lt;code&gt;(ie: ?filename=test.png)&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;image.png&#34; src=&#34;https://drbl4k.github.io/images/In-the-plain-sight/image.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Source: &lt;a href=&#34;https://vickieli.dev/ssrf/ssrf-in-the-wild/&#34;&gt;https://vickieli.dev/ssrf/ssrf-in-the-wild/&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;It’s fascinating, because, we as Pentesters usually go after the core functionalities of an application, (&lt;em&gt;Since it affects the business 😢&lt;/em&gt;)  that could or couldn’t be vulnerable to such attacks, are really missing this perspective of attack vector all together. Let’s leave application pentest realm for a second, imagine conducting an external pentest, and encountering an application vulnerable to a full read SSRF attack and letting it slide because of the default filters. #horible&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;I would like to share my experience on one of my recent pentest activity, where almost on the last day of the pentest I got hold of a path traversal vulnerability which led to disclosure of internal files.&lt;/p&gt;
&lt;p&gt;Real Application Details:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Microsoft IIS server v10&lt;/li&gt;
&lt;li&gt;Internal web app (Bound to be accessed within a restricted environment)&lt;/li&gt;
&lt;li&gt;Has multiple features to download CSV and ZIP files.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Disclaimer&lt;/strong&gt;: the below shown POCs are not from a real world application. Keeping confidentiality in mind I tried to &lt;strong&gt;simulate&lt;/strong&gt; the same attacks over a &lt;strong&gt;secure environment&lt;/strong&gt;. However, the below discussed techniques were used in a real web application assessment.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;On the last day I usually go for analysis of images and other files like PDFs and Excel for metadata exposure and upon applying the Burpsuite filter, one endpoint stood out. It was an endpoint trying to fetch a .zip file from the internal file system.  Now obviously it won’t be visible in the HTTP history due to receiving a binary file &lt;strong&gt;(&lt;em&gt;garbage data&lt;/em&gt;)&lt;/strong&gt; as response. The request had an interesting parameter which was pulling a zip file &lt;code&gt;/download/zip?fnames=UserLog\admin.zip&amp;amp;sec=zip&lt;/code&gt;. It looked something like this in the simulated environment.&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;4.png&#34; src=&#34;https://drbl4k.github.io/images/In-the-plain-sight/4.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;Hmm, We all know what would have been my next move. Yes I tampered the &lt;code&gt;?fnames=&lt;/code&gt; parameter with the payload &lt;code&gt;..\..\..\..\..\testfile&lt;/code&gt; (Note, since the real request had a backslash with the file name, I used a traversal payload with backslashes). The real response for the request was a stack trace error indicating that &lt;code&gt;&amp;quot;The file was not found in the path E:\testfile&amp;quot;&lt;/code&gt;. &lt;strong&gt;(&lt;em&gt;Pro Tip: something as simple as a stack trace could reveal a lot about the backend. #fightwithdevs&lt;/em&gt;)&lt;/strong&gt; Bingo! as soon I got the error indicating the internal file path I figured out where I was, and, I tried to fetch the “web.config” file &lt;strong&gt;(&lt;em&gt;Its a default multi purpose configuration file for IIS servers&lt;/em&gt;)&lt;/strong&gt; from the “E:” directory with the following payload &lt;code&gt;..\..\..\..\..\web.config&lt;/code&gt;. It looked something like this.&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;5.png&#34; src=&#34;https://drbl4k.github.io/images/In-the-plain-sight/5.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt=&#34;6.png&#34; src=&#34;https://drbl4k.github.io/images/In-the-plain-sight/6.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;The web.config file usually throws an error of some kind (403 or 404 usually) if we try to access it directly through a web browser, but because of this path traversal vulnerability, I was able to access it and show the impact. In my case the file consisted details about the SMTP configuration with keys present in it. (&lt;em&gt;I was on top of the world&lt;/em&gt;)&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Moral of the story, never trust any (&lt;em&gt;and I mean &lt;strong&gt;ANY&lt;/strong&gt;&lt;/em&gt;) of the functionalities. By assuming so, we may giveaway the chance to find something cool. Even something as simple as a &lt;strong&gt;default Burpsuite filter&lt;/strong&gt;, which hides images and binary data will act against us. Let’s be honest, who doesn’t want to find and exploit a local file inclusion or an SSRF? not me at least.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;References:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://hackerone.com/reports/1888808&#34;&gt;https://hackerone.com/reports/1888808&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://hackerone.com/reports/1427086&#34;&gt;https://hackerone.com/reports/1427086&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://vickieli.dev/ssrf/ssrf-in-the-wild/&#34;&gt;https://vickieli.dev/ssrf/ssrf-in-the-wild/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Happy Hunting Fellas.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Yours Truly: DRBL4K&lt;/em&gt;&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Fact</title>
      <link>https://drbl4k.github.io/posts/web-is-vulnerable/</link>
      <pubDate>Sun, 27 Jul 2025 21:10:21 +0530</pubDate>
      
      <guid>https://drbl4k.github.io/posts/web-is-vulnerable/</guid>
      <description>Web Is Vulnerable</description>
      <content>&lt;p&gt;Web Is Vulnerable&lt;/p&gt;
</content>
    </item>
    
  </channel>
</rss>
