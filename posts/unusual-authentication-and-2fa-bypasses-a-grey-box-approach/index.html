<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Unusual Authentication and 2FA Bypasses (A Grey-Box Approach) :: drbl4k blogs</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Taking different approaches for Auth/2FA bypasses" />
<meta name="keywords" content=", " />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://drbl4k.github.io/posts/unusual-authentication-and-2fa-bypasses-a-grey-box-approach/" />


  







  
  
  
  
  
  <link rel="stylesheet" href="https://drbl4k.github.io/styles.css">







  <link rel="shortcut icon" href="https://drbl4k.github.io/img/theme-colors/green.png">
  <link rel="apple-touch-icon" href="https://drbl4k.github.io/img/theme-colors/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Unusual Authentication and 2FA Bypasses (A Grey-Box Approach)">
<meta property="og:description" content="Taking different approaches for Auth/2FA bypasses" />
<meta property="og:url" content="https://drbl4k.github.io/posts/unusual-authentication-and-2fa-bypasses-a-grey-box-approach/" />
<meta property="og:site_name" content="drbl4k blogs" />

  
  
  <meta property="og:image" content="https://drbl4k.github.io/">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-08-01 00:10:21 &#43;0530 IST" />













  


</head>
<body class="green">




<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    BL4K&#39;s Blogs
  </div>
</a>

    </div>
    
    
  </div>
  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://drbl4k.github.io/posts/unusual-authentication-and-2fa-bypasses-a-grey-box-approach/">Unusual Authentication and 2FA Bypasses (A Grey-Box Approach)</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-08-01</time><span class="post-author">drbl4k</span>
    
<span class="post-reading-time">5 min read (998 words)</span></div>

  
    <span class="post-tags">
      
      #<a href="https://drbl4k.github.io/tags/auth-bypass/">Auth Bypass</a>&nbsp;
      
      #<a href="https://drbl4k.github.io/tags/2fa-bypass/">2FA Bypass</a>&nbsp;
      
    </span>
  
  



  

  <div class="post-content"><div>
        <p>Authentication and 2FA bypasses have some “usual” methodologies, and I would like to keep them under honorable mentions as we are not covering them today. Also when we talk about authentication &amp; 2FA bypasses specifically, we often think about a scenario where we manage to log into an application/asset without valid verifier/password. That is what I have covered today.</p>
<p>Today’s blog is all about my experience with weird bypasses that I encountered during various pentest activities. Yes the techniques are covered as well. <em>(#igotchu)</em></p>
<hr>
<h3 id="honorable-mentions">Honorable Mentions<a href="#honorable-mentions" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Auth/2FA bypass via <strong>typical</strong> response manipulation (“200 OK” scenario)</li>
<li>SQL injection for login bypasses. (OR 1=1 — or something better)</li>
<li>JWT with none algorithm set in the request. (Mostly outdated)</li>
<li>OTP brute-force without rate limiting. (Typical test case)</li>
<li>OTP reuse (extremely rare and a usual test case)</li>
</ul>
<p>Now keeping the above out of the way, let’s begin with the unusual stuff.</p>
<hr>
<blockquote>
<p><em><strong>Disclaimer</strong>: the below shown POCs are not from a real world application. Keeping confidentiality in mind I tried to <strong>simulate</strong> the same attacks over a <strong>secure environment</strong>. However, the below discussed techniques were used in a real web application assessment.</em></p>
</blockquote>
<hr>
<h3 id="authentication-bypass">Authentication Bypass<a href="#authentication-bypass" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ol>
<li><em><strong>An IDOR based authentication bypass (response manipulation):</strong></em></li>
</ol>
<p>You can test this out in applications with multiple user roles/accounts where, the email and the role ID are returned in the response.</p>
<p>Original Request:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;Username&#34;</span>: <span style="color:#e6db74">&#34;pt-readonly&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;Password&#34;</span>: <span style="color:#e6db74">&#34;SuperSecurePassword&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Original Response:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;success&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;pt-readonly&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;roleID&#34;</span>: <span style="color:#e6db74">&#34;4&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Simply try logging in with a set of credentials and intercept the response. Once the response is received, change the email and role ID to a different user <em><strong>(this may vary as some apps might return only email and some generic parameters like date name etc.)</strong></em> and forward the response. Now check weather the you logged in as a different user.</p>
<p>Original Response:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;success&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;pt-readonly&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;roleID&#34;</span>: <span style="color:#e6db74">&#34;4&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Tampered Response:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;success&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;id&#34;</span>: <span style="color:#e6db74">&#34;pt-admin&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;roleID&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>sometimes just tampering the “roleID” might lead to privilege escalation, but that depends on various other factors.</p>
<ol>
<li><em><strong>JWT None algorithm tampered in response (response manipulation):</strong></em></li>
</ol>
<p>Lets say, you have done basic response manipulation, but you noticed that the server returns a token on a successful login. In this case, log into the application once and copy the token. Set the algorithm type to “None” and remove the signature. Now try intercepting the response again with a wrong password, and paste the token parameter with the crafted token in the response and forward it. This may vary on the basis of signature. You may require a dummy one to be part of the crafted token in some apps.</p>
<p>Original JWT:</p>
<pre tabindex="0"><code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAZXhhbXBsZS5jb20iLCJyb2xlIjoidXNlciIsInJvbGVfaWQiOiIxMDAyIiwiZXhwIjoxNzIyNDI1Mjc3fQ._Ml1VzOvHcmKHY2ElPBWjHbNdG56pYBvAhyHZdcSIAI
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
{&#34;alg&#34;: &#34;HS256&#34;,&#34;typ&#34;: &#34;JWT&#34;}.{&#34;email&#34;: &#34;user@example.com&#34;,&#34;role&#34;: &#34;user&#34;,&#34;role_id&#34;: &#34;1002&#34;,&#34;exp&#34;: 1722425277}._Ml1VzOvHcmKHY2ElPBWjHbNdG56pYBvAhyHZdcSIAI
</code></pre><p>None Alg JWT:</p>
<pre tabindex="0"><code>eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6ImFkbWluQGV4YW1wbGUuY29tIiwicm9sZSI6ImFkbWluIiwicm9sZV9pZCI6IjEwMDEiLCJleHAiOjE3MjI0MjUyNzd9.
---------------------------------------------------------------------------------------------------------------------------------------------
{&#34;alg&#34;: &#34;none&#34;,&#34;typ&#34;: &#34;JWT&#34;}.{&#34;email&#34;: &#34;user@example.com&#34;,&#34;role&#34;: &#34;user&#34;,&#34;role_id&#34;: &#34;1002&#34;,&#34;exp&#34;: 1722425277}.
</code></pre><p>Original Response:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;success&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;token&#34;</span>: <span style="color:#e6db74">&#34;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6InVzZXJAZXhhbXBsZS5jb20iLCJyb2xlIjoidXNlciIsInJvbGVfaWQiOiIxMDAyIiwiZXhwIjoxNzIyNDI1Mjc3fQ.._Ml1VzOvHcmKHY2ElPBWjHbNdG56pYBvAhyHZdcSIAI&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;roleID&#34;</span>: <span style="color:#e6db74">&#34;4&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Bypass response:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#e6db74">&#34;success&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;token&#34;</span>: <span style="color:#e6db74">&#34;eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6ImFkbWluQGV4YW1wbGUuY29tIiwicm9sZSI6ImFkbWluIiwicm9sZV9pZCI6IjEwMDEiLCJleHAiOjE3MjI0MjUyNzd9.&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;roleID&#34;</span>: <span style="color:#e6db74">&#34;4&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ol>
<li><em><strong>Hardcoded token/credentials (JavaScript analysis):</strong></em></li>
</ol>
<p>This one is pretty hard as most apps are secure enough not to include such blunders in code. But who knows? this was encountered personally by myself during a pentest 😎. Go to the Burp’s HTTP History and filter all the .js (JavaScript) &amp; .json files. select a request and paste the username format/email/JWT regex. and move through the requests. there is 1 in a million chance for that.</p>
<p><img alt="/image.png" src="/images/Unusual-Authentication-and-2FA-Bypases/image.png"></p>
<p>here is a list of regex that could help you out while searching for some hardcoded stuff,</p>
<ul>
<li>“^[a-zA-Z0-9]+([._-][a-zA-Z0-9]+)*@[a-zA-Z0-9-]+.[a-zA-Z]{2,}$”   — <strong>Covers emails</strong>.</li>
<li>“eyJ[A-Za-z0-9_-]+?.[A-Za-z0-9_-]+?.[A-Za-z0-9_-]+”   — <strong>Covers JWT tokens</strong>.</li>
<li>“\b(?:(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2}).){3}(?:25[0-5]|2[0-4][0-9]|1?[0-9]{1,2})\b”   — <strong>IPv4 address</strong>.</li>
<li>“\b(?:[A-Fa-f0-9]{1,4}:){7}[A-Fa-f0-9]{1,4}\b”  — <strong>IPv6 address</strong>.</li>
</ul>
<hr>
<h3 id="two-factor-authentication-bypass">Two Factor Authentication Bypass<a href="#two-factor-authentication-bypass" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p><em>(For this part I’m not covering usual things like brute force and response copy pate, identifying static OTPs as they those will be identified by Burp’s active scan.</em>)</p>
<p>This is interesting because, the third one really was a new approach to OTP bypass which doesn’t involve touching the OTP at all (#tempting) 🤓.</p>
<ol>
<li><em><strong>Downgrade APIs to lower version:</strong></em></li>
</ol>
<p>This one is pretty close to my heart, I found this downgrade issue across multiple apps where upon downgrading the API version say from v2 to v1, I managed to revel some sensitive (unintended) information about the flow and this in most cases allow OTP brute forcing, response manipulation. Maybe in some cases a default OTP would be present for that particular version (Haven’t got but heard).</p>
<p>Version 2 Request (Original):</p>
<pre tabindex="0"><code>POST /api**/v2/**verify-otp HTTP/1.1
Host: example.com
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  &#34;email&#34;: &#34;user@example.com&#34;,
  &#34;otp&#34;: &#34;927314&#34;
}
</code></pre><p>Version 1 Request (Tampered):</p>
<pre tabindex="0"><code>POST /api**/v1/**verify-otp HTTP/1.1
Host: example.com
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  &#34;email&#34;: &#34;user@example.com&#34;,
  &#34;otp&#34;: &#34;927314&#34;
}
</code></pre><ol>
<li><strong>Force Browsing Authenticated Page:</strong></li>
</ol>
<p>This is a rare thing to find but still out there in the wild. <strong>A race condition</strong> which allows to force browse the home page directly after the first level of Authentication <em>(password entry)</em>. Let’s break this down.</p>
<p><img alt="https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms" src="/images/Unusual-Authentication-and-2FA-Bypases/image2.png"></p>
<p>Source: <a href="https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms">https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms</a></p>
<p>This happens because a multi step sequence takes place within the span of a single request. This means that the user temporarily has a valid session, but MFA isn&rsquo;t yet being enforce. This allows an attacker to force browse the home page before entering the OTP.</p>
<ol>
<li><strong>Chaining Host Header Injection with OTP emails <em>(#Research):</em></strong></li>
</ol>
<p>We all know that if an application is vulnerable to host header injection, we go straight to password reset functionalities to the same for link poisoning and stuff. What if, an application takes an Email to authenticate with an OTP later has this issue?. Imagine this in a black box application where you have a valid username and password, but 2FA ends up like this. <em>(Actively researching).</em></p>
<hr>
<h3 id="key-takeaways">Key Takeaways<a href="#key-takeaways" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Always tamper the response if emails/roles are returned for horizontal account bypasses</li>
<li>Try setting a none algorithm token via response manipulation (if returned in response)</li>
<li>Always look into the JavaScript files for exposures (Check files like main.js, index.js etc.)</li>
<li>Always make sure to downgrade the APIs if higher numbers are present as current version.</li>
<li>Make sure to force browse the authenticated page before entering the OTP/Passcode.</li>
</ul>
<hr>
<h3 id="references">References<a href="#references" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p><a href="https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms">https://portswigger.net/web-security/race-conditions#session-based-locking-mechanisms</a></p>
<p><a href="https://hackerone.com/reports/2463279">https://hackerone.com/reports/2463279</a></p>
<p><a href="https://hackerone.com/reports/1490470">https://hackerone.com/reports/1490470</a></p>
<p><a href="https://www.hackerone.com/blog/penetration-testing-api">https://www.hackerone.com/blog/penetration-testing-api</a></p>
<hr>
<p><strong>Happy Hunting Fellas.</strong></p>
<p><em>Yours Truly: DRBL4K</em></p>

      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h"></span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="https://drbl4k.github.io/posts/in-the-plain-sight/">
                <span class="button__text">In The Plain Sight - A Classic Filter Mistake</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/mirus-ua/hugo-theme-re-terminal" target="_blank">Theme</a> made by <a href="https://github.com/mirus-ua" target="_blank">Mirus</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>








  
</div>

</body>
</html>
