<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Client Side Decryption - Decrypting Hashed Request and Responses Part -1 (Web App Version) :: drbl4k blogs</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Decrypting requests and responses (level= easy misconfig= static iv)." />
<meta name="keywords" content=", " />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://drbl4k.github.io/posts/client-side-decryption---decrypting-hashed-request-24186941a0fe8084a048f057f478a8df/" />


  







  
  
  
  
  
  <link rel="stylesheet" href="https://drbl4k.github.io/styles.css">







  <link rel="shortcut icon" href="https://drbl4k.github.io/img/theme-colors/green.png">
  <link rel="apple-touch-icon" href="https://drbl4k.github.io/img/theme-colors/green.png">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Client Side Decryption - Decrypting Hashed Request and Responses Part -1 (Web App Version)">
<meta property="og:description" content="Decrypting requests and responses (level= easy misconfig= static iv)." />
<meta property="og:url" content="https://drbl4k.github.io/posts/client-side-decryption---decrypting-hashed-request-24186941a0fe8084a048f057f478a8df/" />
<meta property="og:site_name" content="drbl4k blogs" />

  
  
  <meta property="og:image" content="https://drbl4k.github.io/">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-08-01 08:17:26 &#43;0530 IST" />













  


</head>
<body class="green">




<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="https://drbl4k.github.io/">
  <div class="logo">
    BL4K&#39;s Blogs
  </div>
</a>

    </div>
    
    
  </div>
  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://drbl4k.github.io/posts/client-side-decryption---decrypting-hashed-request-24186941a0fe8084a048f057f478a8df/">Client Side Decryption - Decrypting Hashed Request and Responses Part -1 (Web App Version)</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-08-01</time><span class="post-author">drbl4k</span>
    
<span class="post-reading-time">5 min read (939 words)</span></div>

  
    <span class="post-tags">
      
      #<a href="https://drbl4k.github.io/tags/decryption/">Decryption</a>&nbsp;
      
      #<a href="https://drbl4k.github.io/tags/cryptography/">Cryptography</a>&nbsp;
      
      #<a href="https://drbl4k.github.io/tags/client-side/">Client-Side</a>&nbsp;
      
    </span>
  
  



  

  <div class="post-content"><div>
        <p>We all must have encountered that one particular app which encrypts very single POST/GET request that is being sent. Worst part is that even the response received will be encrypted and cannot be viewed at proxy level (Inside Burp). <strong>Pretty annoying isn‚Äôt it</strong>. In today‚Äôs blog lets cover one of the cryptographic misconfigurations that took place on the encryption part and how I managed to get the decryption logic and expanded my capabilities further.</p>
<p>The picture below is what the blog is gonna be about. (Just so you don‚Äôt wonder whether this is the right blogüòù)</p>
<p><img alt="1.jpeg" src="https://drbl4k.github.io/images/decryption/1.jpeg"></p>
<p><em><strong>Spoiler</strong></em>: In this blog‚Äôs case I managed to find the static keys and iv and proceeded for further decryption. I <strong>used Chat-GPT</strong> to make me a script for decryption. However, applications do encrypt and decrypt on runtime as well. We have to understand the logic of encryption in order to figure out the same <em><strong>(#comingsoon)</strong></em>.</p>
<hr>
<h3 id="base-logic"><em>Base Logic</em><a href="#base-logic" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Let‚Äôs say we have an application and we are able view the data inside of it on the <strong>browser level</strong>. Now at the <strong>proxy level</strong>, things take a turn, as the request and response become <strong>encrypted</strong> (unreadable). This it self means that, on the browser/front end code, there should be a logic present somewhere, to encrypt and decrypt the request and responses. Having this thing cleared is important in order to know what exactly are we looking for.</p>
<p><em><strong>What are we looking for?:</strong></em></p>
<ul>
<li>The logic of encryption and decryption. (Inside JavaScript files)</li>
<li>Understand the algorithm and padding type.</li>
<li>Understand how the key and iv are fetched and trace it back.</li>
<li>Check if iv re-use takes place or a static iv is present. <em><strong>(Big misconfiguration)</strong></em></li>
</ul>
<p>Since we know what we are looking for now, let‚Äôs dive into the techniques of decryption üòé</p>
<hr>
<h3 id="techniques"><em>Techniques</em><a href="#techniques" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Setup the Burpsuite and load the application and make a login request. This should have triggered all sorts of files/logic required for encryption and decryption. Now in the HTTP history, search for the following key words,</p>
<ul>
<li>.encrypt</li>
<li>.decrypt</li>
<li>encfunction</li>
<li>CryptoJS.AES</li>
<li>.crypt</li>
<li>encryptAes</li>
</ul>
<p>The above keywords should lead you to some sort of encryption logic. Also when looking for key words, if you come across files like <code>crypto.min.js</code>, then quite frankly that‚Äôs where the logic is gonna be. But in my case it was inside the <code>chunk.js</code> file.</p>
<p><em>Keyword:</em></p>
<p><img alt="keyword.png" src="https://drbl4k.github.io/images/decryption/keyword.png"></p>
<p><em>Encryption Logic:</em></p>
<p><img alt="logic.jpeg" src="https://drbl4k.github.io/images/decryption/logic.jpeg"></p>
<p>Based on the number of occurrences you might have to scroll through a lot of code to find the logic. In my case the logic is not obfuscated <em>(you can flag this as a security issue after successful decryption)</em> . Now, since we found the logic lets go ahead and hook these functions via developer console. Open the dev console and navigate to ‚ÄúSources‚Äù. Search any particular term from the logic to find the function. hook whatever you feel like is the place of encryption. In my case I hooked at the lines shown in the below image. After hooking try refreshing or making a POST request to trigger the logic. Now you can hover over the key and the iv to get the values.</p>
<p><img alt="2.jpeg" src="https://drbl4k.github.io/images/decryption/2.jpeg"></p>
<p><img alt="3.jpeg" src="https://drbl4k.github.io/images/decryption/3.jpeg"></p>
<p>What do I have till now:</p>
<ul>
<li>Got the Logic for both encryption and decryption.</li>
<li>AES 128 CBC has been used.</li>
<li>Pkcs5Pad padding has been used.</li>
<li>The key and the iv are recoverable in Unit8Array format.</li>
</ul>
<p>Now before proceeding with the decryption part, let‚Äôs discuss where the developers had misconfigured. Its critical to understand to expands our capabilities.</p>
<hr>
<h3 id="the-vulnerability"><em>The vulnerability</em><a href="#the-vulnerability" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>The application was using a <strong>static iv and a key</strong> to encrypt and decrypt. Iv is something that should <strong>not be re-used</strong> after a single encryption/decryption takes place. <em>(This should be flagged upon successful decryption)</em></li>
<li>AES-CBC is an outdated encryption mode. the logic of it is easy to break.</li>
<li>Even if the key and the iv is present in the form of Unit8Array, it still can be used for decryption.</li>
<li>There was no obfuscation on the logic whatsoever. In most cases unlike a Unit8Array, you can find hardcoded keys which can directly be used for decryption.</li>
</ul>
<hr>
<h3 id="decrypting-everything"><em>Decrypting Everything</em><a href="#decrypting-everything" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Since we have the Unit8Array of both key and iv, I asked chat GPT to write me a html file with a decryption script for the identified logic. here is what it gave me:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">title</span>&gt;Offline AES-CBC Decryption&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js&#34;</span>&gt;&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">h2</span>&gt;Decryption Output&lt;/<span style="color:#f92672">h2</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">pre</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;output&#34;</span>&gt;Decrypting...&lt;/<span style="color:#f92672">pre</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Replace with your actual Uint8Array key and IV
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">keyArray</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>([<span style="color:#e6db74">&#34;add the array here&#34;</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ivArray</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Uint8Array</span>([<span style="color:#e6db74">&#34;add the array here&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ciphertextHex</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;acf94ec15f5ef42ec7994ee0e01c92a779682ab797330ee01dacd8a9c2fc5df7 &#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">decryptAES_CBC</span>(<span style="color:#a6e22e">ciphertextHex</span>, <span style="color:#a6e22e">keyArray</span>, <span style="color:#a6e22e">ivArray</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">key</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">lib</span>.<span style="color:#a6e22e">WordArray</span>.<span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">keyArray</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">iv</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">lib</span>.<span style="color:#a6e22e">WordArray</span>.<span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">ivArray</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ciphertext</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">Hex</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">ciphertextHex</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">decrypted</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">AES</span>.<span style="color:#a6e22e">decrypt</span>(
</span></span><span style="display:flex;"><span>        { <span style="color:#a6e22e">ciphertext</span> },
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">key</span>,
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">iv</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">iv</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">mode</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">mode</span>.<span style="color:#a6e22e">CBC</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">padding</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">pad</span>.<span style="color:#a6e22e">Pkcs7</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>      );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">decrypted</span>.<span style="color:#a6e22e">toString</span>(<span style="color:#a6e22e">CryptoJS</span>.<span style="color:#a6e22e">enc</span>.<span style="color:#a6e22e">Utf8</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">plaintext</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">decryptAES_CBC</span>(<span style="color:#a6e22e">ciphertextHex</span>, <span style="color:#a6e22e">keyArray</span>, <span style="color:#a6e22e">ivArray</span>);
</span></span><span style="display:flex;"><span>      document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;output&#34;</span>).<span style="color:#a6e22e">innerText</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">plaintext</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#34;[Decryption failed]&#34;</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>      document.<span style="color:#a6e22e">getElementById</span>(<span style="color:#e6db74">&#34;output&#34;</span>).<span style="color:#a6e22e">innerText</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Error: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">err</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p><img alt="5.jpeg" src="https://drbl4k.github.io/images/decryption/5.jpeg"></p>
<p><img alt="7.jpeg" src="https://drbl4k.github.io/images/decryption/7.jpeg"></p>
<p>Post running this script on an the mentioned encrypted text, I was able to decrypt the values. Now this opens up a lot of possibilities for things like IDOR, SQL Injections etc. I just have to generate another script to encrypt the body with the same key and iv (impactful isn&rsquo;t it).</p>
<hr>
<h3 id="key-takeaways"><em>Key Takeaways</em><a href="#key-takeaways" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li>Always look into the code, (cannot be bypassed XD)</li>
<li>Analyze how keys are used and check whether they are static across multiple accounts/sessions.</li>
<li>Its not bad to ask for help, (Ask AI).</li>
<li>Be clear with padding types as they might cause failure of decryption</li>
<li>encryption should not be the sole line of defense. Comprehensive security testing must be conducted for potential vulnerabilities at multiple levels.</li>
</ul>
<hr>
<h3 id="references">References<a href="#references" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<ul>
<li><a href="https://www.linkedin.com/pulse/how-i-exploited-idor-encrypted-mobile-api-withfrida-george-joseph-rydjc/?trackingId=dwlmpvH4Qyil87BHWllpYw%3D%3D">https://www.linkedin.com/pulse/how-i-exploited-idor-encrypted-mobile-api-withfrida-george-joseph-rydjc/?trackingId=dwlmpvH4Qyil87BHWllpYw%3D%3D</a></li>
</ul>
<hr>
<p><strong>Happy Hunting Fellas.</strong></p>
<p><em>Yours Truly: DRBL4K</em></p>

      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h"></span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="https://drbl4k.github.io/posts/unusual-authentication-and-2fa-bypasses-a-grey-box-approach/">
                <span class="button__text">Unusual Authentication and 2FA Bypasses (A Grey-Box Approach)</span>
                <span class="button__icon">‚Üí</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>¬© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/mirus-ua/hugo-theme-re-terminal" target="_blank">Theme</a> made by <a href="https://github.com/mirus-ua" target="_blank">Mirus</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="https://drbl4k.github.io/bundle.min.js"></script>








  
</div>

</body>
</html>
